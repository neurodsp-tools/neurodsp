<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Morlet Wavelet Analysis &#8212; neurodsp 2.2.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172142294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172142294-1');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          neurodsp</a>
        <span class="navbar-text navbar-version pull-left"><b>2.2.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../reference.html">Reference</a></li>
                <li><a href="https://github.com/neurodsp-tools/neurodsp">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-tutorials-timefreq-plot-morletwavelet-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="morlet-wavelet-analysis">
<span id="sphx-glr-auto-tutorials-timefreq-plot-morletwavelet-py"></span><h1>Morlet Wavelet Analysis<a class="headerlink" href="#morlet-wavelet-analysis" title="Permalink to this headline">¶</a></h1>
<p>Perform time-frequency decomposition using wavelets.</p>
<p>In this tutorial we will use Morlet wavelets to compute a time-frequency
representation of the data.</p>
<p>This tutorial primarily covers the <code class="docutils literal notranslate"><span class="pre">neurodsp.timefrequency.wavelets</span></code> module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Import simulation and plot code to create &amp; visualize data</span>
<span class="kn">from</span> <span class="nn">neurodsp.sim</span> <span class="kn">import</span> <span class="n">sim_combined</span>
<span class="kn">from</span> <span class="nn">neurodsp.plts</span> <span class="kn">import</span> <a href="../../generated/neurodsp.plts.plot_time_series.html#neurodsp.plts.plot_time_series" title="neurodsp.plts.plot_time_series" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_time_series</span></a><span class="p">,</span> <a href="../../generated/neurodsp.plts.plot_timefrequency.html#neurodsp.plts.plot_timefrequency" title="neurodsp.plts.plot_timefrequency" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_timefrequency</span></a>
<span class="kn">from</span> <span class="nn">neurodsp.utils</span> <span class="kn">import</span> <span class="n">create_times</span>

<span class="c1"># Import function for Morlet Wavelets</span>
<span class="kn">from</span> <span class="nn">neurodsp.timefrequency.wavelets</span> <span class="kn">import</span> <a href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform" class="sphx-glr-backref-module-neurodsp-timefrequency sphx-glr-backref-type-py-function"><span class="n">compute_wavelet_transform</span></a>
</pre></div>
</div>
<section id="simulate-data">
<h2>Simulate Data<a class="headerlink" href="#simulate-data" title="Permalink to this headline">¶</a></h2>
<p>First, we’ll simulate a time series using the <a class="reference internal" href="../../generated/neurodsp.sim.combined.sim_combined.html#neurodsp.sim.combined.sim_combined" title="neurodsp.sim.combined.sim_combined"><code class="xref py py-func docutils literal notranslate"><span class="pre">sim_combined()</span></code></a> function
to create a time-varying oscillation.</p>
<p>For this example, our oscillation frequency will be 20 Hz, with a sampling rate of 500 Hz,
and a simulation time of 10 seconds.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define general settings for across the example</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># Define settings for the simulated oscillation</span>
<span class="n">n_seconds</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">exp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># Define settings for creating the simulated signal</span>
<span class="n">comps</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sim_powerlaw&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;exponent&#39;</span> <span class="p">:</span> <span class="n">exp</span><span class="p">,</span> <span class="s1">&#39;f_range&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)},</span>
         <span class="s1">&#39;sim_bursty_oscillation&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;freq&#39;</span> <span class="p">:</span> <span class="n">freq</span><span class="p">}}</span>
<span class="n">comp_vars</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Simulate a signal with bursty oscillations at 20 Hz</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">sim_combined</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">comp_vars</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">create_times</span><span class="p">(</span><span class="n">n_seconds</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a segment of our simulated time series</span>
<a href="../../generated/neurodsp.plts.plot_time_series.html#neurodsp.plts.plot_time_series" title="neurodsp.plts.plot_time_series" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_time_series</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_001.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_001.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/></section>
<section id="compute-wavelet-transform">
<h2>Compute Wavelet Transform<a class="headerlink" href="#compute-wavelet-transform" title="Permalink to this headline">¶</a></h2>
<p>Now, let’s use the compute Morlet wavelet transform algorithm to compute a
time-frequency representation of our simulated data, using Morlet wavelets.</p>
<p>To apply the continuous Morlet wavelet transform, we need to specify frequencies of
interest. The wavelet transform can then be used to compute the power at these
frequencies across time.</p>
<p>For this example, we’ll compute the Morlet wavelet transform on 50 equally-spaced
frequencies from 5 Hz to 100 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for the wavelet transform algorithm</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Compute wavelet transform using compute Morlet wavelet transform algorithm</span>
<span class="n">mwt</span> <span class="o">=</span> <a href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform" class="sphx-glr-backref-module-neurodsp-timefrequency sphx-glr-backref-type-py-function"><span class="n">compute_wavelet_transform</span></a><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">freqs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot morlet wavelet transform</span>
<a href="../../generated/neurodsp.plts.plot_timefrequency.html#neurodsp.plts.plot_timefrequency" title="neurodsp.plts.plot_timefrequency" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_timefrequency</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">mwt</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_002.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_002.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><p>In the plot above, we can see the time-frequency representation from the
Morlet-wavelet transformed signal.</p>
<p>Note that having simulated a bursty signal at 20 Hz, we can see that the
time-frequency representation shows periods with high power at this frequency.</p>
<section id="computing-wavelets-across-different-frequency-ranges">
<h3>Computing wavelets across different frequency ranges<a class="headerlink" href="#computing-wavelets-across-different-frequency-ranges" title="Permalink to this headline">¶</a></h3>
<p>If we want to compute the time-frequency representation across a different frequency range,
we can change the frequencies passed to the Morlet wavelet transform algorithm.</p>
<p>For the next example, let’s use an array of frequencies from 15 Hz to 50 Hz with a
spacing of 5 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for the wavelet transform algorithm</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Compute wavelet transform using compute Morlet wavelet transform algorithm</span>
<span class="n">mwt</span> <span class="o">=</span> <a href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform" class="sphx-glr-backref-module-neurodsp-timefrequency sphx-glr-backref-type-py-function"><span class="n">compute_wavelet_transform</span></a><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">freqs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot morlet wavelet transform</span>
<a href="../../generated/neurodsp.plts.plot_timefrequency.html#neurodsp.plts.plot_timefrequency" title="neurodsp.plts.plot_timefrequency" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_timefrequency</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">mwt</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_003.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_003.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><p>From the plot above, you can see the Morlet-wavelet transformed signal for the new frequency
range. Again, we can see the how power at the frequency of our simulated oscillation.</p>
</section>
</section>
<section id="wavelet-description">
<h2>Wavelet Description<a class="headerlink" href="#wavelet-description" title="Permalink to this headline">¶</a></h2>
<p>Let’s look a little further into what a Wavelet is. In general, a wavelet is simply a small
“wave” like signal. By sweeping this wave across our data, we can see how much of this ‘wave’
is in our signal, which is useful to quantify variations of signal amplitude across time.</p>
<p>A Morlet wavelet is a particular type of wavelet in which the wavelet has been multiplied
by a Gaussian envelope.</p>
<p>Some parameters are needed to define a Morlet wavelet. These parameters are the
sampling frequency, the fundamental frequency, and the number of cycles per frequency.</p>
<p>For more information on Morlet wavelets, see:
<a class="reference external" href="https://www.youtube.com/watch?v=7ahrcB5HL0k">Morlet wavelets in time and frequency</a>
a video on Youtube from Mike X Cohen.</p>
<section id="example-plot-of-morlet-wavelet">
<h3>Example Plot of Morlet Wavelet<a class="headerlink" href="#example-plot-of-morlet-wavelet" title="Permalink to this headline">¶</a></h3>
<p>Here, we provide an example plot of an individual Morlet wavelet. We’ll use the
<cite>scipy.signal</cite> function <cite>morlet</cite> to create a wavelet that is 5 cycles long.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define sampling rate, number of cycles, fundamental frequency, and length for the wavelet</span>
<span class="n">n_cycles</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">scaling</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">n_cycles</span>
<span class="n">wavelet_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_cycles</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">freq</span><span class="p">)</span>

<span class="c1"># Create wavelet</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">morlet</span><span class="p">(</span><span class="n">wavelet_len</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">scaling</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the real part of the wavelet</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">wavelet</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_004.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_004.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/></section>
<section id="real-imaginary-dimensions">
<h3>Real &amp; Imaginary Dimensions<a class="headerlink" href="#real-imaginary-dimensions" title="Permalink to this headline">¶</a></h3>
<p>Note that wavelets have both real and imaginary dimensions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot both real and imaginary dimensions of the wavelet</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">wavelet</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">wavelet</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_005.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_005.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot real and imaginary components in a 3D plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">scaling</span><span class="p">,</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">wavelet</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Scaling&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Real Amplitude&#39;</span><span class="p">,</span> <span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;Imag Amplitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_006.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_006.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[Text(-0.04176715375665995, -0.09042854049259537, &#39;Scaling&#39;), Text(0.0704766587855572, -0.07320235304988142, &#39;Real Amplitude&#39;), Text(0.10787434422876363, 0.014452421710067038, &#39;Imag Amplitude&#39;)]
</pre></div>
</div>
<p>In the plots above, you can see both the real and imaginary components of the Morlet-wavelet.</p>
<p>Note that the function we have been using, <a class="reference internal" href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_wavelet_transform()</span></code></a>
creates Morlet wavelets in the same way we have been doing here, by using the
<cite>morlet</cite> function from scipy.</p>
</section>
<section id="changing-parameters">
<h3>Changing Parameters<a class="headerlink" href="#changing-parameters" title="Permalink to this headline">¶</a></h3>
<p>Adjusting the input parameters results in a different wavelet.</p>
<p>For example, let’s try this same plot but with a different number of cycles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define settings for a new wavelet</span>
<span class="n">n_cycles</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">scaling</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">n_cycles</span>
<span class="n">wavelet_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_cycles</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="n">freq</span><span class="p">)</span>

<span class="c1"># Create wavelet</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">morlet</span><span class="p">(</span><span class="n">wavelet_len</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">scaling</span><span class="p">)</span>

<span class="c1"># Plot wavelet</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">wavelet</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">wavelet</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_007.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_007.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><p>As you can see, when you increase the n_cycles parameter, you get more oscillations (cycles)
in the wavelet.</p>
</section>
</section>
<section id="time-frequency-representations">
<h2>Time-Frequency Representations<a class="headerlink" href="#time-frequency-representations" title="Permalink to this headline">¶</a></h2>
<p>Let’s now return to the Morlet wavelet transform we were originally using. How this function
works is it creates wavelets, as we’ve been doing above, and then applies them to the data
with the <a class="reference internal" href="../../generated/neurodsp.timefrequency.convolve_wavelet.html#neurodsp.timefrequency.convolve_wavelet" title="neurodsp.timefrequency.convolve_wavelet"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve_wavelet()</span></code></a> function. This function convolves the raw signal with
our complex Morlet wavelet.</p>
<p>The complex Morlet wavelet can be thought of as a complex sine tapered by a Gaussian. The
result of the convolution returns a complex array (with real and imaginary components, like
we plotted above) which represents how much power of the frequency of the wavelet was
found in our signal.</p>
<section id="id1">
<h3>Changing Parameters<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Returning to the Morlet-wavelet transform algorithm, we can adjust input parameters
to demonstrate how changes in the number of cycles per frequency affects the outputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the wavelet transform with a higher number of cycles</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">mwt</span> <span class="o">=</span> <a href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform" class="sphx-glr-backref-module-neurodsp-timefrequency sphx-glr-backref-type-py-function"><span class="n">compute_wavelet_transform</span></a><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">freqs</span><span class="p">)</span>

<span class="c1"># Plot the wavelet transform</span>
<a href="../../generated/neurodsp.plts.plot_timefrequency.html#neurodsp.plts.plot_timefrequency" title="neurodsp.plts.plot_timefrequency" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_timefrequency</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">mwt</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_008.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_008.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><p>As you can see, increasing n_cycles results in what looks like smoother pattern of activity
across time. This is because the wavelets, with more cycles, are longer. This can help
increase frequency resolution, but decreases temporal resolution, due to the time-frequency
trade off.</p>
<p>If we adjust other input parameters, such as the frequency resolution, we can also get a
different result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the wavelet transform with a different set of frequencies</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">mwt</span> <span class="o">=</span> <a href="../../generated/neurodsp.timefrequency.compute_wavelet_transform.html#neurodsp.timefrequency.compute_wavelet_transform" title="neurodsp.timefrequency.compute_wavelet_transform" class="sphx-glr-backref-module-neurodsp-timefrequency sphx-glr-backref-type-py-function"><span class="n">compute_wavelet_transform</span></a><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">freqs</span><span class="p">)</span>

<span class="c1"># Plot the wavelet transform</span>
<a href="../../generated/neurodsp.plts.plot_timefrequency.html#neurodsp.plts.plot_timefrequency" title="neurodsp.plts.plot_timefrequency" class="sphx-glr-backref-module-neurodsp-plts sphx-glr-backref-type-py-function"><span class="n">plot_timefrequency</span></a><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">mwt</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_MorletWavelet_009.png" srcset="../../_images/sphx_glr_plot_MorletWavelet_009.png" alt="plot MorletWavelet" class = "sphx-glr-single-img"/><p>In the above, we used a larger frequency step, with the same starting and ending frequencies.</p>
<p>Doing so changes the frequency resolution of our estimation.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.778 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-timefreq-plot-morletwavelet-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9ceff5a30767bda3627759b58a431672/plot_MorletWavelet.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_MorletWavelet.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/91b724252a500326cccd2b64622b6388/plot_MorletWavelet.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_MorletWavelet.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2023, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>